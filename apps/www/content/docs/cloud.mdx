---
title: Cloud
description: Cloud plugin
docs:
  - route: /docs/components/cloud
    title: Cloud
---

<ComponentPreview name="cloud-demo" padding="md" />

## Features

Plate Cloud is the official Plate plugin and cloud service for image and attachment uploads, automatic server-side image resizing, and future Plate cloud services.

It supports:

- Drag and drop uploading of images and attachments
- Paste uploading of images and attachments
- Using a file picker for uploading images and attachment
- Drag resize of images with server-side image resizing which optimizes download speed
- Automatically delivers high DPI images to high DPI devices and normal sized images to everyone else

Your usage of Plate Cloud supports the development of Plate.

You can start by [getting a free Portive API key](https://admin.portive.com/).

## Installation

```bash
npm install @udecode/plate-cloud
```

## Usage

To use Plate Cloud, you will need to [get a free Portive API key](https://www.portive.com/).

To get the value to save to your database, use `editor.cloud.getSaveValue()`. This is required for Plate Cloud because of the asynchronous nature of uploads.

### Options

```tsx
/**
 * CloudPlugin options
 */
export type CloudPlugin = {
    /**
   * Options for connecting to the official Portive Cloud service
   *
   * Either `apiKey` or `authToken` must be provided
   */
  apiKey?: string | () => string | () => Promise<string>;
  authToken?: string | () => string | () => Promise<string>;
  apiOrigin?: string;
  /**
   * Only used for testing to prepopulate the current state of uploads
   */
  uploadStoreInitialValue?: Record<string, Upload>;
};

/**
 * CloudAttachmentPlugin options (none at the moment)
 */
export type CloudAttachmentPlugin = {};

/**
 * CloudImagePlugin options
 */

export type CloudImagePlugin = {
  /**
   * Choose a max width/height to display for when an image is first update.
   * The image is always uploaded at full size so this is not about the
   * stored resolution of the image.
   */
  maxInitialWidth?: number;
  maxInitialHeight?: number;
};
```

### Source Code

- [Cloud Plugin](https://github.com/udecode/plate/blob/plate-ui-tw/packages/cloud/src/cloud/createCloudPlugin.ts)
- [Cloud Attachment Plugin](https://github.com/udecode/plate/blob/plate-ui-tw/packages/cloud/src/attachment/createCloudAttachmentPlugin.ts)
- [Cloud Image Plugin](https://github.com/udecode/plate/blob/plate-ui-tw/packages/cloud/src/image/createCloudImagePlugin.ts)
- [packages/cloud](https://github.com/udecode/plate/tree/main/packages/cloud)

## API

[createCloudAttachmentPlugin.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fattachment%2FcreateCloudAttachmentPlugin.ts)

### TCloudAttachmentElement

[useCloudAttachmentElementState.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fattachment%2FuseCloudAttachmentElementState.ts)
[withCloudAttachment.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fattachment%2FwithCloudAttachment.ts)

[createCloudPlugin.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fcloud%2FcreateCloudPlugin.ts)
[getInProgressUploads.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fcloud%2FgetInProgressUploads.ts)
[withCloud.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fcloud%2FwithCloud.ts)
[getSaveValue.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fcloud%2FgetSaveValue.ts)
[onDropCloud.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fcloud%2Fhandlers.ts)
[onPasteCloud.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fcloud%2Fhandlers.ts)
[uploadFiles.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fcloud%2FuploadFiles.ts)
[finishUploads.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fcloud%2FfinishUploads.ts)
[generateSrcAndSrcSet.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fcloud%2FgenerateSrcAndSrcSet.ts)
[createCloudImagePlugin.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fimage%2FcreateCloudImagePlugin.ts)
[useCloudImageElementState.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fimage%2FuseCloudImageElementState.ts)
[withCloudImage.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fimage%2FwithCloudImage.ts)
[createUploadStore.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fupload%2FcreateUploadStore.ts)
[useUpload.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fupload%2FuseUpload.ts)

```tsx
/**
 * Specifies just the `options` part of the CloudPlugin
 */
export type CloudPlugin = ClientOptions & {
  uploadStoreInitialValue?: Record<string, Upload>;
};

export type PlateCloudEditor<V extends Value = Value> = PlateEditor<V> &
  CloudEditorProps<V>;

export type CloudEditorProps<V extends Value = Value> = {
  cloud: {
    client: Client;
    uploadFiles: (msg: any) => void;
    uploadStore: ReturnType<typeof createUploadStore>;
    genericFileHandlers?: {
      onStart?: (e: FileEvent) => void;
      onProgress?: (e: FileEvent & ProgressEvent) => void;
      onError?: (e: FileEvent & ErrorEvent) => void;
      onSuccess?: (e: FileEvent & SuccessEvent) => void;
    };
    imageFileHandlers?: {
      onStart?: (e: ImageFileEvent) => void;
      onProgress?: (e: ImageFileEvent & ProgressEvent) => void;
      onError?: (e: ImageFileEvent & ErrorEvent) => void;
      onSuccess?: (e: ImageFileEvent & SuccessEvent) => void;
    };
    getSaveValue: () => V;
    finishUploads: (options?: { maxTimeoutInMs?: number }) => Promise<void>;
    // save: (options: { maxTimeoutInMs?: number }) => Promise<V>;
  };
};

export type CloudImagePlugin = {
  maxInitialWidth?: number;
  maxInitialHeight?: number;
  minResizeWidth?: number;
  maxResizeWidth?: number;
};

export type CloudImageEditorProps = {
  cloudImage: {
    maxInitialWidth: number;
    maxInitialHeight: number;
    minResizeWidth: number;
    maxResizeWidth: number;
  };
};

export type PlateCloudImageEditor<V extends Value = Value> = PlateEditor<V> &
  CloudImageEditorProps;

export interface TCloudImageElement extends TElement {
  url: string;
  bytes: number;
  width: number;
  height: number;
  maxWidth: number;
  maxHeight: number;
}
```
